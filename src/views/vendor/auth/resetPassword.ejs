<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reset Password - ChronoMy</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/resetPassword.css">
</head>
<body>
    <!-- Reset Password Container -->
    <div class="reset-password-container">
        <div class="reset-password-card">
            <!-- Heading -->
            <h1 class="reset-password-title">Enter new Password</h1>

            <!-- Error Display -->
            <% if (error) { %>
                <div 
                    id="errorBox"
                    class="alert alert-danger mb-4"
                    role="alert">
                    <%= error %>
                </div>
            <% } %>

            <!-- Reset Password Form -->
            <form id="resetPasswordForm" class="reset-password-form" method="POST" action="/vendor/auth/reset-password">
                <!-- New Password Input -->
                <div class="password-input-group mb-3">
                    <input 
                        type="password" 
                        id="newPassword" 
                        name="newPassword"
                        class="form-control reset-password-input" 
                        placeholder="Enter new Password"
                        required
                        autocomplete="new-password"
                    >
                    <span class="password-toggle" onclick="togglePasswordVisibility('newPassword')">
                        üëÅÔ∏è
                    </span>
                </div>

                <!-- Confirm Password Input -->
                <div class="password-input-group mb-3">
                    <input 
                        type="password" 
                        id="confirmPassword" 
                        name="confirmPassword"
                        class="form-control reset-password-input" 
                        placeholder="Confirm new password"
                        required
                        autocomplete="new-password"
                    >
                    <span class="password-toggle" onclick="togglePasswordVisibility('confirmPassword')">
                        üëÅÔ∏è
                    </span>
                </div>

                <!-- Password Match Error Message -->
                <div id="passwordMatchError" class="alert alert-danger d-none">
                    Passwords do not match
                </div>

                <!-- Verify Button -->
                <button type="submit" class="btn btn-verify w-100">Reset Password</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Toggle password visibility
        function togglePasswordVisibility(fieldId) {
            const field = document.getElementById(fieldId);
            field.type = field.type === 'password' ? 'text' : 'password';
        }

        // Password match validation
        document.getElementById('resetPasswordForm').addEventListener('submit', function(e) {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const errorDiv = document.getElementById('passwordMatchError');

            if (newPassword !== confirmPassword) {
                e.preventDefault();
                errorDiv.classList.remove('d-none');
            } else {
                errorDiv.classList.add('d-none');
            }
        });

        // ‚úÖ Auto-hide server error EXACTLY in 3 seconds
        const errorBox = document.getElementById("errorBox");
        if (errorBox) {
            errorBox.style.transition = "opacity 0.5s ease";

            // Start fade at 2.5s
            setTimeout(() => {
                errorBox.style.opacity = "0";
            }, 1500);

            // Remove at 3s
            setTimeout(() => {
                errorBox.remove();
            }, 2000);
        }
    </script>
</body>
</html>
